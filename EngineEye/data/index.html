<!DOCTYPE html>
<html>

<head>
    <!--Engine Monitor HTML-->
    <!--<meta http-equiv='refresh' content='4'>-->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Engine Parameters</title>
    <link rel="stylesheet" type="text/css" href="style.css">

    <script type="text/javascript">
        
        
        function hotText(elemID, level) {
            var tempelem = document.getElementById(elemID);
            var tempnum = parseInt(tempelem.innerHTML, 10);

            if (tempnum > level) {
                tempelem.style.color = "red";
            } else {
                tempelem.style.color = "black";
            }
        }

        var Socket;

        function init() {
            Socket = new WebSocket('ws://' + window.location.hostname + ':81/');
            //var Socket = new WebSocket('ws://192.168.4.1:81/');
            Socket.onmessage = function(event) {
                processReceivedCommand(event);
            };
        }

        function processReceivedCommand(evt) {
            var data = JSON.parse(evt.data);
            document.getElementById('revs').innerHTML = data.rpm;
            document.getElementById('voltage').innerHTML = data.voltage;
            document.getElementById('temp1F').innerHTML = data.temp1;
            document.getElementById('temp2F').innerHTML = data.temp2;
            hotText("temp1F", 450);
            hotText("temp2F", 250);
            hotText("voltage", 14.5);
            hotText("revs", 4100);
        }
    </script>
</head>

<body onload="javascript:init()">
    <div class="main_block">

        <div class="section">
            <h3> <span id="temp1F_title">Head Temperature</span> </h3>
            <meter id="temp1_meter" value="{{TEMP1F}}" min="50" max="500">head temp</meter>
            <h2> <span id="temp1F">{{TEMP1F}}</span> F </h2>
        </div><br>

        <div class="section">
            <h3> <span id="temp2F_title">Oil Temperature</span> </h3>
            <meter id="temp2_meter" value="{{TEMP2F}}" min="50" max="300">oil temp</meter>
            <h2> <span id="temp2F">{{TEMP2F}}</span> F </h2>
        </div><br>

        <div class="section">
            <h3> <span id="voltage_title">Generator Voltage</span> </h3>
            <meter id="volt_meter" value="{{VOLTAGE}}" min="0" max="15">gen volts</meter>
            <h2> <span id="voltage">{{VOLTAGE}}</span> V</h2>
        </div><br>

        <div class="section">
            <h3> <span id="rev_title">Revolutions / Min</span> </h3>
            <!--<meter id="rev_meter" value="{{REVS}}" min="0" max="6000">rpm</meter>-->
            <h2> <span id="revs">---</span> RPM</h2>
        </div><br>

    </div>
 </body>

</html>